---
title: "Исследование метаданных DNS трафика"
author: "nastya5908@yandex.ru"
editor: visual
format: 
  md:
    output-file: README.md
---

## Цель работы

1.  Закрепить практические навыки использования языка программирования R для обработки данных
2.  Закрепить знания основных функций обработки данных экосистемы tidyverse языка R
3.  Закрепить навыки исследования метаданных DNS трафика

## Исходные данные

1.  Программное обеспечение Windows 11
2.  Rstudio Desktop
3.  Интерпретатор языка R 4.5.1

## План:

1.  Импортировать и подготовить данные

2.  Проанализировать метаданные DNS трафика

3.  Составить отчет и выложить его и исходный qmd/rmd файл в свой репозиторий

## Шаги
Установим и подключим необходимые библиотеки

```{r}
library(dplyr)
```

```{r}
library(tidyverse)
```

```{r}
library(readr)
```
#### Подготовка данных

1\.  Импортируем данные DNS
```{r}
download.file("https://storage.yandexcloud.net/dataset.ctfsec/dns.zip", "dns.zip")
```

```{r}
unzip("dns.zip")
```

```{r}
dns <- read_tsv("dns.log", comment = "#", col_names = FALSE)
```

2\. Добавим пропущенные данные о структуре данных (назначении столбцов)
```{r}
col_names <- c(
  "timestamp", "uid", "source_ip", "source_port", "destination_ip", 
  "destination_port", "protocol", "transaction_id", "query", "qclass", 
  "qclass_name", "qtype", "qtype_name", "rcode", "rcode_name", 
  "AA", "TC", "RD", "RA", "Z", "answer", "TTLS", "rejected"
)
```

```{r}
colnames(dns) <- col_names
```
3\. Преобразуем данные в столбцах в нужный формат
```{r}
dns <- dns |> mutate(timestamp = as_datetime(timestamp),
                      source_port = as.numeric(source_port),
                      qclass = as.numeric(qclass),
                      qtype = as.numeric(qtype))
```
Посмотрим общую структуру данных
```{r}
glimpse(dns)
```
#### Анализ
4\. Сколько участников информационного обмена в
сети Доброй Организации?

```{r}
length(unique(c(dns$source_ip, dns$destination_ip)))
```
5\. Какое соотношение участников обмена внутри
сети и участников обращений к внешним
ресурсам?

```{r}

```
6\. Найдите топ-10 участников сети, проявляющих
наибольшую сетевую активность.

```{r}
dns |> count(source_ip, sort = TRUE) |> head(10)
```
7\. Найдите топ-10 доменов, к которым обращаются
пользователи сети и соответственное количество
обращений

```{r}
dns |> count(query, sort = TRUE) |> head(10)
```
8\. Опеределите базовые статистические
характеристики (функция summary() ) интервала
времени между последовательными обращениями
к топ-10 доменам.
```{r}

```
9\. Часто вредоносное программное обеспечение
использует DNS канал в качестве канала
управления, периодически отправляя запросы на
подконтрольный злоумышленникам DNS сервер.
По периодическим запросам на один и тот же
домен можно выявить скрытый DNS канал. Есть ли
такие IP адреса в исследуемом датасете?
```{r}

```
#### Обогащение данных
10\. Определите местоположение (страну, город) и
организацию-провайдера для топ-10 доменов. Для
этого можно использовать сторонние сервисы,
например http://ip-api.com (API-эндпоинт –
http://ip-api.com/json).
```{r}

```
## Вывод
